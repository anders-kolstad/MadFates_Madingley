<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Norway - default settings | Runniging the Madingley Model with Norwegian data</title>
  <meta name="description" content="Chapter 5 Norway - default settings | Runniging the Madingley Model with Norwegian data" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Norway - default settings | Runniging the Madingley Model with Norwegian data" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Norway - default settings | Runniging the Madingley Model with Norwegian data" />
  
  
  

<meta name="author" content="Anders L. Kolstad" />


<meta name="date" content="2021-12-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="step-4---spin-up-and-demonstrating-plotting-functions.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.19/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.10.20/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.10.20/js/dataTables.fixedColumns.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#some-useful-links"><i class="fa fa-check"></i><b>1.1</b> Some useful links</a><ul>
<li class="chapter" data-level="1.1.1" data-path="index.html"><a href="index.html#examples-of-use"><i class="fa fa-check"></i><b>1.1.1</b> Examples of use</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#terms-and-definitions"><i class="fa fa-check"></i><b>1.2</b> Terms and definitions</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a></li>
<li class="chapter" data-level="3" data-path="step-1---3.html"><a href="step-1---3.html"><i class="fa fa-check"></i><b>3</b> Step 1 - 3</a><ul>
<li class="chapter" data-level="3.1" data-path="step-1---3.html"><a href="step-1---3.html#step-1---load-data"><i class="fa fa-check"></i><b>3.1</b> Step 1 - Load data</a></li>
<li class="chapter" data-level="3.2" data-path="step-1---3.html"><a href="step-1---3.html#step-2---modify-input-parameters"><i class="fa fa-check"></i><b>3.2</b> Step 2 - Modify input parameters</a></li>
<li class="chapter" data-level="3.3" data-path="step-1---3.html"><a href="step-1---3.html#step-3---initialisation"><i class="fa fa-check"></i><b>3.3</b> Step 3 - Initialisation</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="step-4---spin-up-and-demonstrating-plotting-functions.html"><a href="step-4---spin-up-and-demonstrating-plotting-functions.html"><i class="fa fa-check"></i><b>4</b> Step 4 - Spin-up and demonstrating plotting functions</a></li>
<li class="chapter" data-level="5" data-path="norway---default-settings.html"><a href="norway---default-settings.html"><i class="fa fa-check"></i><b>5</b> Norway - default settings</a><ul>
<li class="chapter" data-level="5.1" data-path="norway---default-settings.html"><a href="norway---default-settings.html#grid-cells"><i class="fa fa-check"></i><b>5.1</b> 16 grid cells</a></li>
<li class="chapter" data-level="5.2" data-path="norway---default-settings.html"><a href="norway---default-settings.html#single-grid-cell"><i class="fa fa-check"></i><b>5.2</b> Single grid cell</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Runniging the Madingley Model with Norwegian data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="norway---default-settings" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Norway - default settings</h1>
<p>This is just a first look at what the model predicts for Norway with default settings.</p>
<p>This page was last updated <code>2021-12-17 12:19:46</code></p>
<p>First we try with 4 x 4 grid cells (16 grid cells, with dispersion) in south-central Norway. Then we try with just one grid cell, but a longer temporal scope.</p>
<div id="grid-cells" class="section level2">
<h2><span class="header-section-number">5.1</span> 16 grid cells</h2>
<p>Lets start with a too big bonding box for illustration.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="norway---default-settings.html#cb1-1"></a>spatial_window =<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">12</span>, <span class="dv">58</span>, <span class="dv">65</span>)</span>
<span id="cb1-2"><a href="norway---default-settings.html#cb1-2"></a><span class="kw">plot_spatialwindow</span>(spatial_window)</span></code></pre></div>
<p><img src="04-Norway1_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>The default resolution is 1 degree, giving (7 x 7 =) 49 cells in this case, which is too much for testing purpuses due to compuatation time. The resolution is defined by the spatial input rasters, but 1 degree resolution is the maximum. Finer resolution is possible, ut not courser. I will therefore focus on just Central Norway. Plotting on top of mean annual temperature.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="norway---default-settings.html#cb2-1"></a>mat =<span class="st"> </span><span class="kw">mean</span>(sptl_inp[[<span class="dv">10</span>]])</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="norway---default-settings.html#cb3-1"></a>spatial_window =<span class="st"> </span><span class="kw">c</span>(<span class="dv">6</span>, <span class="dv">10</span>, <span class="dv">59</span>, <span class="dv">63</span>)</span>
<span id="cb3-2"><a href="norway---default-settings.html#cb3-2"></a><span class="kw">plot_spatialwindow</span>(spatial_window, </span>
<span id="cb3-3"><a href="norway---default-settings.html#cb3-3"></a>                   <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">55</span>,<span class="dv">65</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">20</span>),</span>
<span id="cb3-4"><a href="norway---default-settings.html#cb3-4"></a>                   <span class="dt">input_raster =</span> mat)</span></code></pre></div>
<p><img src="04-Norway1_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>Notice how at high latitudes, one degree north-south is much longer in distance compared to 1 degree east-west.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="norway---default-settings.html#cb4-1"></a>mdata &lt;-<span class="st">  </span><span class="kw">madingley_init</span>(<span class="dt">spatial_window =</span> spatial_window,</span>
<span id="cb4-2"><a href="norway---default-settings.html#cb4-2"></a>                       <span class="dt">cohort_def =</span> chrt_def,</span>
<span id="cb4-3"><a href="norway---default-settings.html#cb4-3"></a>                       <span class="dt">stock_def =</span> stck_def,</span>
<span id="cb4-4"><a href="norway---default-settings.html#cb4-4"></a>                       <span class="dt">spatial_inputs =</span> sptl_inp,</span>
<span id="cb4-5"><a href="norway---default-settings.html#cb4-5"></a>                       <span class="dt">max_cohort =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>% Processing: realm_classification, land_mask, hanpp, available_water_capacity
% Processing: Ecto_max, Endo_C_max, Endo_H_max, Endo_O_max
% Processing: terrestrial_net_primary_productivity_1-12
% Processing: near-surface_temperature_1-12
% Processing: precipitation_1-12
% Processing: ground_frost_frequency_1-12
% Processing: diurnal_temperature_range_1-12
% </code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="norway---default-settings.html#cb6-1"></a>mdata2 &lt;-<span class="st">  </span><span class="kw">madingley_run</span>(</span>
<span id="cb6-2"><a href="norway---default-settings.html#cb6-2"></a>  <span class="dt">out_dir =</span> <span class="st">&quot;temp&quot;</span>,</span>
<span id="cb6-3"><a href="norway---default-settings.html#cb6-3"></a>  <span class="dt">madingley_data =</span> mdata, </span>
<span id="cb6-4"><a href="norway---default-settings.html#cb6-4"></a>  <span class="dt">years =</span> <span class="dv">10</span>, </span>
<span id="cb6-5"><a href="norway---default-settings.html#cb6-5"></a>  <span class="dt">cohort_def =</span> chrt_def, </span>
<span id="cb6-6"><a href="norway---default-settings.html#cb6-6"></a>  <span class="dt">stock_def =</span> stck_def, </span>
<span id="cb6-7"><a href="norway---default-settings.html#cb6-7"></a>  <span class="dt">spatial_inputs =</span> sptl_inp, </span>
<span id="cb6-8"><a href="norway---default-settings.html#cb6-8"></a>  <span class="dt">model_parameters =</span> mdl_prms,</span>
<span id="cb6-9"><a href="norway---default-settings.html#cb6-9"></a>  <span class="dt">max_cohort =</span> <span class="dv">100</span>,</span>
<span id="cb6-10"><a href="norway---default-settings.html#cb6-10"></a>  <span class="dt">silenced =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>% Warning in system(run_exec, intern = T): running command &#39;&quot;C:/Users/
% anders.kolstad/Documents/R/R-4.1.1/library/MadingleyR/win_exec/madingley.bat&quot;&#39;
% had status 5</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="norway---default-settings.html#cb8-1"></a><span class="co"># Runtime approx 15 sec</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="norway---default-settings.html#cb9-1"></a><span class="kw">plot_timelines</span>(mdata2)</span></code></pre></div>
<pre><code>% Warning in xtfrm.data.frame(x): cannot xtfrm data frames

% Warning in xtfrm.data.frame(x): cannot xtfrm data frames</code></pre>
<p><img src="04-Norway1_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>The 10 year spin up was probably way too short, and we can see much variation or instability, but none the less, the seasonal patterns is visible for both autotrophs and heterotrophs, but it it much to little. There should be almost no ectotherm biomass in winter. Bird migration I don’t think is accounted for either. I predict this will be the biggest challenge - getting the Madingley model to capture the seasonal phenological stages.</p>
<p>Exploring the cohorts in mdata2. Looking only at herbivorous endotherms, we can look at the relationship between individual size and abundance</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="norway---default-settings.html#cb11-1"></a>temp &lt;-<span class="st"> </span>mdata2<span class="op">$</span>cohorts</span>
<span id="cb11-2"><a href="norway---default-settings.html#cb11-2"></a>temp &lt;-<span class="st"> </span>temp[temp<span class="op">$</span>FunctionalGroupIndex<span class="op">==</span><span class="dv">0</span>,]</span>
<span id="cb11-3"><a href="norway---default-settings.html#cb11-3"></a></span>
<span id="cb11-4"><a href="norway---default-settings.html#cb11-4"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> temp)<span class="op">+</span></span>
<span id="cb11-5"><a href="norway---default-settings.html#cb11-5"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">log</span>(IndividualBodyMass), </span>
<span id="cb11-6"><a href="norway---default-settings.html#cb11-6"></a>                 <span class="dt">y =</span>  <span class="kw">log</span>(CohortAbundance)</span>
<span id="cb11-7"><a href="norway---default-settings.html#cb11-7"></a>                 ),</span>
<span id="cb11-8"><a href="norway---default-settings.html#cb11-8"></a>             <span class="dt">alpha=</span>.<span class="dv">1</span>, </span>
<span id="cb11-9"><a href="norway---default-settings.html#cb11-9"></a>             <span class="dt">size=</span><span class="dv">8</span>, </span>
<span id="cb11-10"><a href="norway---default-settings.html#cb11-10"></a>             <span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>,</span>
<span id="cb11-11"><a href="norway---default-settings.html#cb11-11"></a>             <span class="dt">pch=</span><span class="dv">16</span>)<span class="op">+</span></span>
<span id="cb11-12"><a href="norway---default-settings.html#cb11-12"></a><span class="st">  </span><span class="kw">theme_bw</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="04-Norway1_files/figure-html/unnamed-chunk-7-1.png" width="480" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="norway---default-settings.html#cb12-1"></a><span class="co"># plotting all grid cells and all cohorts or FG 0</span></span></code></pre></div>
<p>No relationship.</p>
<p>Lets look at biomass differences between functional groups. First,let make more intuitive names for the functional groups.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="norway---default-settings.html#cb13-1"></a>link &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb13-2"><a href="norway---default-settings.html#cb13-2"></a>  <span class="dt">FG =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>,<span class="dv">1</span>),</span>
<span id="cb13-3"><a href="norway---default-settings.html#cb13-3"></a>  <span class="dt">FGname =</span> <span class="kw">c</span>(<span class="st">&quot;Endo. herb.&quot;</span>,</span>
<span id="cb13-4"><a href="norway---default-settings.html#cb13-4"></a>             <span class="st">&quot;Endo. carn.&quot;</span>,</span>
<span id="cb13-5"><a href="norway---default-settings.html#cb13-5"></a>             <span class="st">&quot;Endo. omni.&quot;</span>,</span>
<span id="cb13-6"><a href="norway---default-settings.html#cb13-6"></a>             <span class="st">&quot;Ecto. sem. herb.&quot;</span>, <span class="co"># semelparous (insect etc)</span></span>
<span id="cb13-7"><a href="norway---default-settings.html#cb13-7"></a>             <span class="st">&quot;Ecto. sem. carn.&quot;</span>,</span>
<span id="cb13-8"><a href="norway---default-settings.html#cb13-8"></a>             <span class="st">&quot;Ecto. sem. omni.&quot;</span>,</span>
<span id="cb13-9"><a href="norway---default-settings.html#cb13-9"></a>             <span class="st">&quot;Ecto. itero. herb.&quot;</span>, <span class="co"># iteroparous (reptiles etc)</span></span>
<span id="cb13-10"><a href="norway---default-settings.html#cb13-10"></a>             <span class="st">&quot;Ecto. itero. carn.&quot;</span>,</span>
<span id="cb13-11"><a href="norway---default-settings.html#cb13-11"></a>             <span class="st">&quot;Ecto. itero. omni.&quot;</span></span>
<span id="cb13-12"><a href="norway---default-settings.html#cb13-12"></a>             )</span>
<span id="cb13-13"><a href="norway---default-settings.html#cb13-13"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="norway---default-settings.html#cb14-1"></a>temp &lt;-<span class="st"> </span>mdata2<span class="op">$</span>cohorts</span>
<span id="cb14-2"><a href="norway---default-settings.html#cb14-2"></a></span>
<span id="cb14-3"><a href="norway---default-settings.html#cb14-3"></a>temp2 &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">data =</span> temp,</span>
<span id="cb14-4"><a href="norway---default-settings.html#cb14-4"></a>                   IndividualBodyMass<span class="op">~</span><span class="kw">factor</span>(FunctionalGroupIndex),</span>
<span id="cb14-5"><a href="norway---default-settings.html#cb14-5"></a>                   <span class="dt">FUN =</span> mean)</span>
<span id="cb14-6"><a href="norway---default-settings.html#cb14-6"></a>temp2<span class="op">$</span>CohortAbundance &lt;-<span class="st"> </span><span class="kw">aggregate</span>(<span class="dt">data =</span> temp,</span>
<span id="cb14-7"><a href="norway---default-settings.html#cb14-7"></a>                   CohortAbundance<span class="op">~</span><span class="kw">factor</span>(FunctionalGroupIndex),</span>
<span id="cb14-8"><a href="norway---default-settings.html#cb14-8"></a>                   <span class="dt">FUN =</span> mean)[,<span class="dv">2</span>]</span>
<span id="cb14-9"><a href="norway---default-settings.html#cb14-9"></a></span>
<span id="cb14-10"><a href="norway---default-settings.html#cb14-10"></a><span class="kw">names</span>(temp2)[<span class="dv">1</span>]&lt;-<span class="st"> &quot;FG&quot;</span></span>
<span id="cb14-11"><a href="norway---default-settings.html#cb14-11"></a></span>
<span id="cb14-12"><a href="norway---default-settings.html#cb14-12"></a>temp2<span class="op">$</span>FG &lt;-<span class="st"> </span><span class="kw">as.character</span>(temp2<span class="op">$</span>FG)</span>
<span id="cb14-13"><a href="norway---default-settings.html#cb14-13"></a>temp2<span class="op">$</span>FGname &lt;-<span class="st"> </span>link<span class="op">$</span>FGname[<span class="kw">match</span>(temp2<span class="op">$</span>FG, link<span class="op">$</span>FG)]</span>
<span id="cb14-14"><a href="norway---default-settings.html#cb14-14"></a></span>
<span id="cb14-15"><a href="norway---default-settings.html#cb14-15"></a></span>
<span id="cb14-16"><a href="norway---default-settings.html#cb14-16"></a><span class="kw">ggplot</span>(temp2, <span class="kw">aes</span>(<span class="dt">x =</span> CohortAbundance,</span>
<span id="cb14-17"><a href="norway---default-settings.html#cb14-17"></a>                 <span class="dt">y =</span> IndividualBodyMass,</span>
<span id="cb14-18"><a href="norway---default-settings.html#cb14-18"></a>                 <span class="dt">label =</span> FGname))<span class="op">+</span></span>
<span id="cb14-19"><a href="norway---default-settings.html#cb14-19"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">position =</span>  <span class="kw">position_dodge2v</span>(<span class="dv">2000</span>))<span class="op">+</span></span>
<span id="cb14-20"><a href="norway---default-settings.html#cb14-20"></a><span class="st">  </span><span class="kw">theme_bw</span>(<span class="dt">base_size =</span> <span class="dv">20</span>)<span class="op">+</span></span>
<span id="cb14-21"><a href="norway---default-settings.html#cb14-21"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">expand =</span> <span class="kw">expansion</span>(<span class="dt">mult=</span><span class="kw">c</span>(.<span class="dv">2</span>,.<span class="dv">2</span>)))<span class="op">+</span></span>
<span id="cb14-22"><a href="norway---default-settings.html#cb14-22"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">expansion</span>(<span class="dt">mult=</span><span class="kw">c</span>(.<span class="dv">2</span>,.<span class="dv">2</span>)))</span></code></pre></div>
<p><img src="04-Norway1_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>Obs, beware of strong dodging in thsi figure in place to be able to read all labels.</p>
<p>Endothermic carnivores and herbivores are the biggest animals, but they make up a low proportion of the total biomass. Omnivorous ectotheric and semelparous species (insects) make up the bulk biomass.</p>
<p>Note: The individual body mass is here the mean of all cohorts. If reproduction is low, mean individual body mass increases because of a higher propotion of older individuals (higher biomass in the cohors containing older individuals).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="norway---default-settings.html#cb15-1"></a><span class="kw">plot_densities</span>(mdata2)</span></code></pre></div>
<pre><code>% loading inputs from: temp/madingley_outs_17_12_21_12_20_01/</code></pre>
<p><img src="04-Norway1_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>I’m not good at reading these figures yet.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="norway---default-settings.html#cb17-1"></a><span class="kw">plot_trophicpyramid</span>(mdata2)</span></code></pre></div>
<pre><code>% loading inputs from: temp/madingley_outs_17_12_21_12_20_01/</code></pre>
<p><img src="04-Norway1_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Hmm, omnivores have a big biomass but only feed on herbivores, not plants.</p>
<p>Create log10-binned food-web plot</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="norway---default-settings.html#cb19-1"></a><span class="kw">plot_foodweb</span>(mdata2, <span class="dt">max_flows =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>% loading inputs from: temp/madingley_outs_17_12_21_12_20_01/</code></pre>
<p><img src="04-Norway1_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>The interactions are dominated by carnivorous insects eating omnivorous insects. Omnivorous insects must have a high turn over, because their combined biomass is low at any one time.</p>
<p>Plot the spatial biomass</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="norway---default-settings.html#cb21-1"></a><span class="kw">plot_spatialbiomass</span>(mdata2, <span class="dt">functional_filter =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>% loading inputs from: temp/madingley_outs_17_12_21_12_20_01/</code></pre>
<p><img src="04-Norway1_files/figure-html/unnamed-chunk-13-1.png" width="864" /></p>
<p>The next step I think is to go though the model parameters in mdl_prms and see if the settings make sense for boreal, mainly forested or alpine, ecosystem. We can also change values in the spatial input sptl_inp, for example setting the max biomass for ectotherms (we don’t have large reptiles here).</p>
</div>
<div id="single-grid-cell" class="section level2">
<h2><span class="header-section-number">5.2</span> Single grid cell</h2>
<p>Using a single grid cell we can run the simulation for longer, and see how that affects things.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="norway---default-settings.html#cb23-1"></a>spatial_window =<span class="st"> </span><span class="kw">c</span>(<span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">60</span>, <span class="dv">61</span>)</span>
<span id="cb23-2"><a href="norway---default-settings.html#cb23-2"></a><span class="kw">plot_spatialwindow</span>(spatial_window, </span>
<span id="cb23-3"><a href="norway---default-settings.html#cb23-3"></a>                   <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">55</span>,<span class="dv">65</span>), <span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="dv">20</span>),</span>
<span id="cb23-4"><a href="norway---default-settings.html#cb23-4"></a>                   <span class="dt">input_raster =</span> mat)</span></code></pre></div>
<p><img src="04-Norway1_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="norway---default-settings.html#cb24-1"></a>mdata &lt;-<span class="st">  </span><span class="kw">madingley_init</span>(<span class="dt">spatial_window =</span> spatial_window,</span>
<span id="cb24-2"><a href="norway---default-settings.html#cb24-2"></a>                       <span class="dt">cohort_def =</span> chrt_def,</span>
<span id="cb24-3"><a href="norway---default-settings.html#cb24-3"></a>                       <span class="dt">stock_def =</span> stck_def,</span>
<span id="cb24-4"><a href="norway---default-settings.html#cb24-4"></a>                       <span class="dt">spatial_inputs =</span> sptl_inp,</span>
<span id="cb24-5"><a href="norway---default-settings.html#cb24-5"></a>                       <span class="dt">max_cohort =</span> <span class="dv">100</span>)</span></code></pre></div>
<pre><code>% Processing: realm_classification, land_mask, hanpp, available_water_capacity
% Processing: Ecto_max, Endo_C_max, Endo_H_max, Endo_O_max
% Processing: terrestrial_net_primary_productivity_1-12
% Processing: near-surface_temperature_1-12
% Processing: precipitation_1-12
% Processing: ground_frost_frequency_1-12
% Processing: diurnal_temperature_range_1-12
% </code></pre>
<p>Using 100 years instead of 10</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="norway---default-settings.html#cb26-1"></a>mdata2 &lt;-<span class="st">  </span><span class="kw">madingley_run</span>(</span>
<span id="cb26-2"><a href="norway---default-settings.html#cb26-2"></a>  <span class="dt">out_dir =</span> <span class="st">&quot;temp&quot;</span>,</span>
<span id="cb26-3"><a href="norway---default-settings.html#cb26-3"></a>  <span class="dt">madingley_data =</span> mdata, </span>
<span id="cb26-4"><a href="norway---default-settings.html#cb26-4"></a>  <span class="dt">years =</span> <span class="dv">100</span>, </span>
<span id="cb26-5"><a href="norway---default-settings.html#cb26-5"></a>  <span class="dt">cohort_def =</span> chrt_def, </span>
<span id="cb26-6"><a href="norway---default-settings.html#cb26-6"></a>  <span class="dt">stock_def =</span> stck_def, </span>
<span id="cb26-7"><a href="norway---default-settings.html#cb26-7"></a>  <span class="dt">spatial_inputs =</span> sptl_inp, </span>
<span id="cb26-8"><a href="norway---default-settings.html#cb26-8"></a>  <span class="dt">model_parameters =</span> mdl_prms,</span>
<span id="cb26-9"><a href="norway---default-settings.html#cb26-9"></a>  <span class="dt">max_cohort =</span> <span class="dv">100</span>,</span>
<span id="cb26-10"><a href="norway---default-settings.html#cb26-10"></a>  <span class="dt">silenced =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>% Warning in system(run_exec, intern = T): running command &#39;&quot;C:/Users/
% anders.kolstad/Documents/R/R-4.1.1/library/MadingleyR/win_exec/madingley.bat&quot;&#39;
% had status 5</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="norway---default-settings.html#cb28-1"></a><span class="co"># Runtime approx 45 sec</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="norway---default-settings.html#cb29-1"></a><span class="kw">plot_timelines</span>(mdata2)</span></code></pre></div>
<pre><code>% Warning in xtfrm.data.frame(x): cannot xtfrm data frames

% Warning in xtfrm.data.frame(x): cannot xtfrm data frames</code></pre>
<p><img src="04-Norway1_files/figure-html/unnamed-chunk-17-1.png" width="672" /></p>
<p>The components seem to stabilise relatively fast, and after ~20 there are no long-term trends (results vary between each time this page is rendered). The relative biomass distribution between functional groups is different. This is probably a characteristic of this grid cell, and how less to do with the number of years simulated by the model.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="step-4---spin-up-and-demonstrating-plotting-functions.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
